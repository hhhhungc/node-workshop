<html lang="en">
    <head>
        <title>XHR</title>
    </head>
    <body>
        <button id="asyncBtn">非同步</button>
        <button id="countBtn">測試按鈕</button>
        <div id="count">0</div>
        <div id="response">準備要顯示訊息</div>

        <script>
            var response = document.getElementById("response");
            var asyncBtn = document.getElementById("asyncBtn");
            asyncBtn.addEventListener("click", function () {
                // 非同步的測試
                response.innerHTML = "開始非同步的請求";

                new Promise((resolve, reject) => {
                    var xhr = new XMLHttpRequest();
                    xhr.onload = function () {
                        if (this.status === 200) {
                            resolve(`非同步請求的response: ${this.responseText}`);
                            // response.innerHTML = `非同步請求的response: ${this.responseText}`;
                        } else {reject(`非同步請求的錯誤訊息: ${this.status}`);
                            // response.innerHTML = `非同步請求的錯誤訊息: ${this.status}`;
                        }
                    };

                    // 非同步true
                    xhr.open("GET", "http://18.237.113.31:3000/", true);
                    xhr.send();
                })
                .then((resolve)=>{
                    response.innerHTML = resolve;
                })
                .catch((reject)=>{
                    response.innerHTML = reject;
                })
            });

            var countBtn = document.getElementById("countBtn");
            var count = document.getElementById("count");
            countBtn.addEventListener("click", function () {
                count.innerHTML = parseInt(count.innerHTML, 10) + 1;
            });
        </script>
    </body>
</html>
